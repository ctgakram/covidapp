@using AppProj.Web.Helpers;
@using AppProj.Web;
@model AppProj.Web.Models.DoctorsPoleModel
@{
    var ajaxOpt = new AjaxOptions
    {
        HttpMethod = "POST",
        UpdateTargetId = "dialog1Body",
        InsertionMode = InsertionMode.Replace,
        OnSuccess = "openDialog1('Suspected Patient')",
        LoadingElementId = "loading",
        OnFailure = "failure"
    };
}
@using (Ajax.BeginForm("Save", "DoctorPole", ajaxOpt))
{
    @Html.ValidationSummary(true)
    if (Model != null)
    {
        @Html.HiddenFor(m => m.Id)
    }
    <table class="table table-striped table-bordered fixed_headers">
        <tr>
            <td>
                <table class="table-striped">
                    <tr>
                        <td class="title">
                            Program
                        </td>
                        <td class="control">
                            @Html.DropDownListFor(model => model.ProgramId, Model.ProgramList)
                            @Html.ValidationMessageFor(model => model.ProgramId)
                        </td>
                    </tr>
                    <tr>
                        <td class="title">
                            Division
                        </td>
                        <td class="control">
                            @Html.DropDownListFor(model => model.DivisionId, Model.DivisionList)
                            @Html.ValidationMessageFor(model => model.DivisionId)
                        </td>
                    </tr>
                    <tr>
                        <td class="title">
                            District
                        </td>
                        <td class="control">
                            @Html.DropDownListFor(model => model.DistrictId, Model.DistrictList)
                            @Html.ValidationMessageFor(model => model.DistrictId)
                        </td>
                    </tr>
                    <tr>
                        <td class="title">
                            Who is Effected
                        </td>
                        <td class="control">
                            @Html.DropDownListFor(model => model.EffectedPersonId, Model.EffectedPersonList)
                            @Html.ValidationMessageFor(model => model.EffectedPersonId)
                        </td>
                    </tr>
                    <tr>

                        <td class="title">
                            Area Office
                        </td>
                        <td class="control">
                            @Html.TextBoxFor(model => model.AreaOffice)
                            @Html.ValidationMessageFor(model => model.AreaOffice)
                        </td>
                    </tr>
                    <tr>

                        <td class="title">
                            PIN
                        </td>
                        <td class="control">
                            @Html.TextBoxFor(model => model.PIN)
                            @Html.ValidationMessageFor(model => model.PIN)
                        </td>
                    </tr>
                    <tr>

                        <td class="title">
                            Name
                        </td>
                        <td class="control">
                            @Html.TextBoxFor(model => model.Name)
                            @Html.ValidationMessageFor(model => model.Name)
                        </td>
                    </tr>
                    <tr>
                        <td class="title">
                            Mobile No
                        </td>
                        <td class="control">
                            @Html.TextBoxFor(model => model.MobileNo)
                            @Html.ValidationMessageFor(model => model.MobileNo)
                        </td>
                    </tr>

                    <tr>
                        <td class="title">
                            Sex
                        </td>
                        <td class="control">
                            @Html.DropDownListFor(model => model.GenderId, Model.GenderList)
                            @Html.ValidationMessageFor(model => model.GenderId)
                        </td>
                    </tr>
                    <tr>
                        <td class="title">
                            Age
                        </td>
                        <td class="control">
                            @Html.TextBoxFor(model => model.Age)
                            @Html.ValidationMessageFor(model => model.Age)
                        </td>
                    </tr>
                    <tr>
                        <td class="title">
                            Comment
                        </td>
                        <td class="control">
                            @Html.TextBoxFor(model => model.CommentByHR)
                            @Html.ValidationMessageFor(model => model.CommentByHR)
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4">
                            Case History
                        </td>
                    </tr>
                    <tr>
                        <td class="title">
                            Any Travel

                        </td>
                        <td class="title">
                            Travel within country?


                        </td>
                        <td class="title">
                            Travel outside country?
                        </td>
                        <td class="title">
                            Contact history
                        </td>
                    </tr>
                    <tr>
                        <td class="title">
                            @Html.CheckBoxFor(model => model.IsTravel)
                        </td>
                        <td class="title">
                            @Html.CheckBoxFor(model => model.IsTravelCountry)
                        </td>
                        <td class="title">
                            @Html.CheckBoxFor(model => model.IsTravelAbroad)
                        </td>
                        <td class="title">
                            @Html.CheckBoxFor(model => model.IsContract)
                        </td>
                    </tr>
                    <tr>
                        <td class="control">
                            <p>
                                <input id="save-submit" type="submit" value="Save New Case" class="btn btn-primary" />
                            </p>
                        </td>
                    </tr>
                </table>
            </td>
            <td style="vertical-align:top;padding-left:10px;">
                <h3>Existing Data of this Staff</h3>
                @if (Model.ExistingData != null)
                {
                    <table class="table table-striped table-bordered fixed_headers">
                        <tr>
                            <th>Name</th>
                            <th>Age</th>
                            <th>Gender</th>
                            <th>Who is effected</th>
                            <th>Entry Date</th>
                            @if (UserRole.Check("DoctorPool_Doc", SessionHelper.Role))
                            {
                                <td>Action</td>
                            }
                        </tr>

                        @foreach (var v in Model.ExistingData)
                        {
                            <tr>
                                <td>@v.Name</td>
                                <td>@v.Age</td>
                                <td>@v.StandingData.Name</td>
                                <td>@v.StandingData4.Name</td>
                                <td>@v.EntryTime.ToString("dd MM, yyyy")</td>
                                @if (UserRole.Check("DoctorPool_Doc", SessionHelper.Role))
                                {
                                    <td>
                                        @Ajax.ActionLink("Followup", "Followup", "DoctorPole", new { id = v.Id }, ajaxOpt, new { @class = "" })
                                    </td>
                                }
                            </tr>
                        }
                    </table>
                }
            </td>
        </tr>
    </table>
}
<script type="text/javascript">
    ValidatateForm("form0");
    $(document).ready(function () {

        $("#save-submit").click(function () {

            if (!confirm("Do you want to Save?")) {
                return false;
            }

        });

        $('#DivisionId').change(function (event) {
            LoadDistrictSearch($('#DivisionId').val());
        });

        window.LoadDistrictSearch = function (areaId) {
                var url = '@Url.Content("~/Main/GetDistrictByDivision")?id=' + areaId;
            LoadDropDownListWithCall('DistrictId'
                    , url
                    , null
                    , null);
        }

        //$('#Dob').datepicker({
        //    format: "dd M, yyyy",
        //    autoclose: true,
        //    endDate: '+0d',
        //    startDate: null
        //});

    });
</script>
